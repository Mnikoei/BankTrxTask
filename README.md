
### صورت مسئله
این پروژه شامل نیازمندی‌های زیر است و برای هر بخش، نحوه پیاده‌سازی توضیح داده شده است:

---

#### نیازمندی:
هر کاربر در سیستم می‌تواند یک شماره موبایل و چندین شماره حساب و به ازای هر شماره حساب، چند شماره کارت داشته باشد.

##### پیاده‌سازی:
- **Entity**های مربوط به کاربر در مسیر زیر قرار داده شده‌اند:  
  `app/Services/User`
- **Entity**های مربوط به تراکنش‌ها در مسیر زیر پیاده شده‌اند:  
  `app/Services/Transaction`
- ریسورس‌های مربوط به شماره حساب، شماره کارت و تراکنش‌ها در مسیر زیر قرار گرفته‌اند:  
  `app/Services/Transaction/Models`

---

#### نیازمندی:
یک **API** بنویسید که شماره کارت مبدا و مقصد را بگیرد و در صورت کفایت موجودی، عملیات انتقال مبلغ را انجام دهد.

##### پیاده‌سازی:
- کنترلر مربوطه در مسیر زیر پیاده‌سازی شده است:  
  `app/Services/Transaction/Http/Controllers/TransferController.php`
- این کنترلر شامل اکشن‌های زیر است:
    - کنترل **idempotency**
    - کنترل **race condition**
    - ایجاد ریسورس‌ها

---

#### نیازمندی:
شماره کارت باید **اعتبارسنجی** شود و فقط شماره کارت‌های معتبر پذیرفته شوند.
- شماره کارت‌های غیرمعتبر مانند `1234-1234-1234-1234` نباید پذیرفته شوند.
- حداقل مبلغ برای تراکنش ۱۰۰۰ تومان و حداکثر ۵۰ میلیون تومان است.
- هر تراکنش ۵۰۰ تومان کارمزد دارد که باید در جدول جداگانه نگهداری شود.
- **API** باید اعداد انگلیسی، فارسی و عربی را پشتیبانی کند.

##### پیاده‌سازی:
- فرم ریکوئست مربوطه در مسیر زیر قرار گرفته است:  
  `app/Services/Transaction/Http/Requests/TransferRequest.php`
- از ماکروی app/Services/Transaction/TransactionServiceProvider.php:39 برای نرمالایز کردن کاراکترها و یک کاستم ولیدیشن برای اعتبارسنجی شماره کارت استفاده شده است.

---

#### نیازمندی:
بعد از انجام تراکنش، برای کاربران مبدا و مقصد پیامک ارسال شود.
- متن پیامک باید توسط توسعه‌دهندگان بعدی به‌راحتی قابل تغییر باشد.
- امکان ارسال پیامک از سرویس‌های زیر وجود داشته باشد:
    - [Kavenegar](https://kavenegar.com/rest.html)
    - [GhasedakSMS](https://ghasedaksms.com/lab)
- سیستم باید قابلیت افزودن سرویس‌های جدید پیامک را داشته باشد.

##### پیاده‌سازی:
- بعد از ایجاد تراکنش، **Event** زیر اجرا می‌شود:  
  `app/Services/Transaction/Events/TransactionSubmitted.php`
- سپس **Listener** زیر پیامک را ارسال می‌کند:  
  `app/Services/User/Listeners/SendSmsToUser.php`
- منطق سرویس پیامک در مسیر زیر پیاده‌سازی شده است:  
  `app/Services/Utils/Sms`
- این پیاده‌سازی از **Manager Pattern** لاراول برای رعایت اصل **Open-Close** و **Strategy Pattern** استفاده کرده است.

---

#### نیازمندی:
یک **API** طراحی کنید که اطلاعات سه کاربری که در ۱۰ دقیقه اخیر بیشترین تراکنش را داشته‌اند، به همراه لیست ۱۰ تراکنش آخر هرکدام بازگرداند.

##### پیاده‌سازی:
- این وب‌سرویس در مسیر زیر قرار گرفته است:  
  `app/Services/Transaction/Http/Controllers/TransactionController.php`

---

### تست‌ها
- اجرای تست‌ها با دستور زیر:
  ```bash
  cd laradock;
  sudo docker-compose exec  workspace composer test;
  ```  
- تست‌های هر سرویس در مسیر مربوط به آن سرویس قرار گرفته‌اند:  
  `app/Services/{SERVICE NAME}/Tests`

---

